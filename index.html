<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexusHR - Hệ thống Quản trị Nhân sự</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel (để biên dịch JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Font chữ Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Hiệu ứng mờ cho dữ liệu nhạy cảm */
        .sensitive-blur { filter: blur(4px); transition: filter 0.3s; cursor: help; }
        .sensitive-blur:hover { filter: blur(0); }
        
        /* Animation */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS (SVG Components thay thế cho lucide-react) ---
        const IconWrapper = ({ children, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Users = ({ size = 24, className }) => <IconWrapper className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconWrapper>;
        const DollarSign = ({ size = 24, className }) => <IconWrapper className={className}><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></IconWrapper>;
        const FileText = ({ size = 24, className }) => <IconWrapper className={className}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></IconWrapper>;
        const Shield = ({ size = 24, className }) => <IconWrapper className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></IconWrapper>;
        const Activity = ({ size = 24, className }) => <IconWrapper className={className}><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></IconWrapper>;
        const Search = ({ size = 24, className }) => <IconWrapper className={className}><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></IconWrapper>;
        const Bell = ({ size = 24, className }) => <IconWrapper className={className}><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></IconWrapper>;
        const ChevronRight = ({ size = 24, className }) => <IconWrapper className={className}><polyline points="9 18 15 12 9 6"/></IconWrapper>;
        const User = ({ size = 24, className }) => <IconWrapper className={className}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconWrapper>;
        const Building = ({ size = 24, className }) => <IconWrapper className={className}><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="9" y1="22" x2="9" y2="22.01"/><line x1="15" y1="22" x2="15" y2="22.01"/><line x1="12" y1="22" x2="12" y2="22.01"/><line x1="12" y1="2" x2="12" y2="6"/><line x1="12" y1="18" x2="12" y2="22"/><line x1="4" y1="10" x2="4" y2="22"/><line x1="20" y1="10" x2="20" y2="22"/><line x1="8" y1="10" x2="8" y2="10.01"/><line x1="8" y1="14" x2="8" y2="14.01"/><line x1="8" y1="18" x2="8" y2="18.01"/><line x1="16" y1="10" x2="16" y2="10.01"/><line x1="16" y1="14" x2="16" y2="14.01"/><line x1="16" y1="18" x2="16" y2="18.01"/></IconWrapper>;
        const Download = ({ size = 24, className }) => <IconWrapper className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></IconWrapper>;
        const Clock = ({ size = 24, className }) => <IconWrapper className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconWrapper>;
        const EyeOff = ({ size = 24, className }) => <IconWrapper className={className}><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></IconWrapper>;
        const Lock = ({ size = 24, className }) => <IconWrapper className={className}><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></IconWrapper>;
        const X = ({ size = 24, className }) => <IconWrapper className={className}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></IconWrapper>;
        const Upload = ({ size = 24, className }) => <IconWrapper className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></IconWrapper>;
        const Save = ({ size = 24, className }) => <IconWrapper className={className}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconWrapper>;
        const Trash2 = ({ size = 24, className }) => <IconWrapper className={className}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></IconWrapper>;
        const UserMinus = ({ size = 24, className }) => <IconWrapper className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="23" y1="11" x2="17" y2="11"/></IconWrapper>;
        const Plus = ({ size = 24, className }) => <IconWrapper className={className}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></IconWrapper>;
        const Edit3 = ({ size = 24, className }) => <IconWrapper className={className}><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></IconWrapper>;


        // --- CẤU HÌNH & DỮ LIỆU MẪU ---

        const ROLES = {
          HR_ADMIN: 'HR_ADMIN',
          HR_OFFICER: 'HR_OFFICER',
          MANAGER: 'MANAGER',
          EMPLOYEE: 'EMPLOYEE',
          TECH_ADMIN: 'TECH_ADMIN'
        };

        const DEPARTMENTS = ['Kỹ thuật (Engineering)', 'Kinh doanh (Sales)', 'Nhân sự (HR)', 'Tài chính (Finance)', 'Ban Giám đốc (Executive)'];

        const INITIAL_EMPLOYEES = [
          {
            id: 'NV-001',
            firstName: 'Sarah',
            lastName: 'Connor',
            email: 'sarah.connor@nexushr.com',
            role: ROLES.HR_ADMIN,
            department: 'Nhân sự (HR)',
            position: 'Giám đốc Nhân sự',
            status: 'Đang làm việc',
            joinDate: '2019-03-15',
            managerId: null,
            location: 'Trụ sở chính',
            avatar: 'SC',
            dob: '1985-05-12',
            gender: 'Nữ',
            nationality: 'Mỹ',
            nationalId: '987-65-4321',
            phone: '+84 901 234 567',
            address: '123 Đường Skynet, TP.HCM',
            emergencyContact: { name: 'Kyle Reese', relation: 'Chồng', phone: '+84 909 999 888' },
            salary: 120000000,
            currency: 'VND',
            salaryHistory: [
              { date: '2019-03-15', amount: 95000000, type: 'Tuyển mới', changedBy: 'Hệ thống' },
              { date: '2023-01-01', amount: 120000000, type: 'Thăng chức', changedBy: 'Hệ thống' }
            ],
            contractType: 'Không xác định',
            documents: [
              { id: 1, name: 'Hop_Dong_Lao_Dong.pdf', type: 'Hợp đồng', date: '2019-03-15', accessLevel: 'HR_ONLY' }
            ]
          },
          {
            id: 'NV-002',
            firstName: 'Trần',
            lastName: 'Văn Bình',
            email: 'binh.tran@nexushr.com',
            role: ROLES.MANAGER,
            department: 'Kỹ thuật (Engineering)',
            position: 'Trưởng phòng Kỹ thuật',
            status: 'Đang làm việc',
            joinDate: '2020-06-01',
            managerId: 'NV-001',
            location: 'Hà Nội',
            avatar: 'TB',
            salary: 85000000,
            currency: 'VND',
            nationalId: '001088000123',
            phone: '0912 345 678',
            address: '456 Kim Mã, Hà Nội',
            emergencyContact: { name: 'Nguyễn Thị Hoa', relation: 'Vợ', phone: '0912 345 679' },
            salaryHistory: [],
            documents: [],
            dob: '1988-01-01',
            gender: 'Nam',
            nationality: 'Việt Nam'
          }
        ];

        const INITIAL_AUDIT_LOGS = [
          { id: 101, timestamp: '2023-10-25 09:15:00', actor: 'Sarah Connor', action: 'CẬP_NHẬT_LƯƠNG', target: 'Trần Văn Bình', details: 'Điều chỉnh lương từ 80tr lên 85tr' },
        ];

        // --- CÁC COMPONENT TIỆN ÍCH ---

        const Card = ({ children, className = "" }) => (
          <div className={`bg-white rounded-lg shadow-sm border border-gray-200 ${className}`}>
            {children}
          </div>
        );

        const Badge = ({ status }) => {
          const styles = {
            'Đang làm việc': 'bg-green-100 text-green-800',
            'Thử việc': 'bg-yellow-100 text-yellow-800',
            'Đã nghỉ việc': 'bg-red-100 text-red-800',
            'Nghỉ phép': 'bg-blue-100 text-blue-800',
          };
          return (
            <span className={`px-2 py-1 rounded-full text-xs font-medium ${styles[status] || 'bg-gray-100 text-gray-800'}`}>
              {status}
            </span>
          );
        };

        const Modal = ({ isOpen, onClose, title, children }) => {
          if (!isOpen) return null;
          return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
              <div className="bg-white rounded-lg w-full max-w-lg mx-4 overflow-hidden shadow-xl animate-fade-in">
                <div className="flex justify-between items-center p-4 border-b border-gray-100">
                  <h3 className="text-lg font-bold text-gray-900">{title}</h3>
                  <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                    <X className="w-5 h-5" />
                  </button>
                </div>
                <div className="p-6 overflow-y-auto max-h-[80vh]">
                  {children}
                </div>
              </div>
            </div>
          );
        };

        // --- ỨNG DỤNG CHÍNH ---

        function NexusHR() {
          const [employees, setEmployees] = useState(INITIAL_EMPLOYEES);
          const [currentUser, setCurrentUser] = useState(INITIAL_EMPLOYEES[0]);
          const [selectedEmployee, setSelectedEmployee] = useState(null);
          const [activeTab, setActiveTab] = useState('overview');
          const [viewMode, setViewMode] = useState('list');
          const [auditLogs, setAuditLogs] = useState(INITIAL_AUDIT_LOGS);
          
          const [modalConfig, setModalConfig] = useState({ isOpen: false, type: null, data: null });
          const [formData, setFormData] = useState({});

          const addAuditLog = (action, targetName, details) => {
            const newLog = {
              id: Date.now(),
              timestamp: new Date().toLocaleString('vi-VN'),
              actor: `${currentUser.firstName} ${currentUser.lastName}`,
              action,
              target: targetName,
              details
            };
            setAuditLogs([newLog, ...auditLogs]);
          };

          const handleOpenModal = (type, data = {}) => {
            setModalConfig({ isOpen: true, type, data });
            setFormData(data); 
          };

          const handleCloseModal = () => {
            setModalConfig({ isOpen: false, type: null, data: null });
            setFormData({});
          };

          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({ ...prev, [name]: value }));
          };

          const handleAddEmployee = (e) => {
            e.preventDefault();
            const newId = `NV-${String(employees.length + 1).padStart(3, '0')}`;
            const newEmployee = {
              ...formData,
              id: newId,
              status: 'Thử việc',
              joinDate: new Date().toISOString().split('T')[0],
              salaryHistory: [],
              documents: [],
              avatar: (formData.firstName?.[0] || 'N') + (formData.lastName?.[0] || 'V'),
              salary: Number(formData.salary) || 0
            };
            
            setEmployees([...employees, newEmployee]);
            addAuditLog('THÊM_NHÂN_VIÊN', `${newEmployee.firstName} ${newEmployee.lastName}`, `Đã thêm nhân viên mới vào phòng ${newEmployee.department}`);
            handleCloseModal();
          };

          const handleUpdatePersonal = (e) => {
            e.preventDefault();
            const updatedEmployees = employees.map(emp => 
              emp.id === selectedEmployee.id ? { ...emp, ...formData } : emp
            );
            setEmployees(updatedEmployees);
            setSelectedEmployee({ ...selectedEmployee, ...formData });
            addAuditLog('CẬP_NHẬT_HỒ_SƠ', `${selectedEmployee.firstName} ${selectedEmployee.lastName}`, 'Cập nhật thông tin liên hệ/cá nhân');
            handleCloseModal();
          };

          const handleSalaryAdjustment = (e) => {
            e.preventDefault();
            const newAmount = Number(formData.newSalary);
            const reason = formData.reason;
            const effectiveDate = formData.effectiveDate;

            const updatedEmployees = employees.map(emp => {
              if (emp.id === selectedEmployee.id) {
                return {
                  ...emp,
                  salary: newAmount,
                  salaryHistory: [
                    ...emp.salaryHistory,
                    { date: effectiveDate, amount: newAmount, type: reason, changedBy: currentUser.lastName }
                  ]
                };
              }
              return emp;
            });

            setEmployees(updatedEmployees);
            const updatedEmp = updatedEmployees.find(e => e.id === selectedEmployee.id);
            setSelectedEmployee(updatedEmp);
            
            addAuditLog('ĐIỀU_CHỈNH_LƯƠNG', `${updatedEmp.firstName} ${updatedEmp.lastName}`, `Lương mới: ${newAmount.toLocaleString('vi-VN')} VND. Lý do: ${reason}`);
            handleCloseModal();
          };

          const handleTerminate = () => {
            if (!window.confirm('CẢNH BÁO: Bạn có chắc chắn muốn thực hiện quy trình nghỉ việc cho nhân viên này? Hành động này sẽ khóa quyền truy cập của họ.')) return;

            const updatedEmployees = employees.map(emp => 
              emp.id === selectedEmployee.id ? { ...emp, status: 'Đã nghỉ việc' } : emp
            );
            setEmployees(updatedEmployees);
            setSelectedEmployee({ ...selectedEmployee, status: 'Đã nghỉ việc' });
            addAuditLog('CHO_NGHỈ_VIỆC', `${selectedEmployee.firstName} ${selectedEmployee.lastName}`, 'Đã chuyển trạng thái sang Đã nghỉ việc');
          };

          const handleUploadDocument = (e) => {
            e.preventDefault();
            const newDoc = {
              id: Date.now(),
              name: formData.fileName || 'Tai_lieu_moi.pdf',
              type: formData.docType,
              date: new Date().toISOString().split('T')[0],
              accessLevel: formData.accessLevel
            };

            const updatedEmployees = employees.map(emp => {
              if (emp.id === selectedEmployee.id) {
                return { ...emp, documents: [...emp.documents, newDoc] };
              }
              return emp;
            });

            setEmployees(updatedEmployees);
            setSelectedEmployee(updatedEmployees.find(e => e.id === selectedEmployee.id));
            addAuditLog('TẢI_TÀI_LIỆU', `${selectedEmployee.firstName} ${selectedEmployee.lastName}`, `Đã tải lên: ${newDoc.name} (${newDoc.accessLevel})`);
            handleCloseModal();
          };

          const permissions = {
            canViewSalary: (viewer, target) => {
              if (viewer.role === ROLES.HR_ADMIN) return true;
              if (viewer.role === ROLES.TECH_ADMIN) return false;
              if (viewer.role === ROLES.MANAGER) return false; 
              if (viewer.id === target.id) return true;
              return false;
            },
            canEditSensitive: (viewer) => viewer.role === ROLES.HR_ADMIN,
            canManage: (viewer) => viewer.role === ROLES.HR_ADMIN,
            canViewDocuments: (viewer, target, docLevel) => {
              if (viewer.role === ROLES.HR_ADMIN) return true;
              if (viewer.id === target.id) return true;
              if (viewer.role === ROLES.MANAGER && target.managerId === viewer.id && docLevel !== 'HR_ONLY') return true;
              return false;
            }
          };

          const Sidebar = () => (
            <div className="w-64 bg-slate-900 text-white h-screen fixed left-0 top-0 flex flex-col z-10 hidden md:flex">
              <div className="p-5 flex items-center space-x-3 border-b border-slate-800">
                <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center font-bold text-white">N</div>
                <span className="text-xl font-bold tracking-tight">NexusHR</span>
              </div>
              
              <div className="flex-1 py-6 space-y-1">
                <SidebarItem icon={<Activity className="w-5 h-5" />} label="Bảng điều khiển" active={false} />
                <SidebarItem icon={<Users className="w-5 h-5" />} label="Nhân viên" active={true} onClick={() => setViewMode('list')} />
                <SidebarItem icon={<FileText className="w-5 h-5" />} label="Hợp đồng" active={false} />
                {currentUser.role === ROLES.HR_ADMIN && (
                  <SidebarItem icon={<DollarSign className="w-5 h-5" />} label="Tính lương" active={false} />
                )}
                {(currentUser.role === ROLES.HR_ADMIN || currentUser.role === ROLES.TECH_ADMIN) && (
                   <SidebarItem icon={<Shield className="w-5 h-5" />} label="Nhật ký hệ thống" active={false} />
                )}
              </div>

              <div className="p-4 border-t border-slate-800">
                <div className="flex items-center space-x-3">
                  <div className="w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center text-sm font-bold">
                    {currentUser.avatar}
                  </div>
                  <div>
                    <div className="text-sm font-medium">{currentUser.firstName}</div>
                    <div className="text-xs text-slate-400">{currentUser.role}</div>
                  </div>
                </div>
              </div>
            </div>
          );

          const SidebarItem = ({ icon, label, active, onClick }) => (
            <button 
              onClick={onClick}
              className={`w-full flex items-center space-x-3 px-6 py-3 transition-colors ${active ? 'bg-blue-600 text-white' : 'text-slate-400 hover:text-white hover:bg-slate-800'}`}
            >
              {icon}
              <span className="text-sm font-medium">{label}</span>
            </button>
          );

          const Header = () => (
            <div className="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 ml-0 md:ml-64 sticky top-0 z-20">
              <div className="flex items-center text-gray-500 space-x-2">
                <span className="hidden sm:inline">Tổ chức</span>
                <ChevronRight className="w-4 h-4 hidden sm:inline" />
                <span className="text-gray-900 font-medium">Nhân sự</span>
              </div>

              <div className="flex items-center space-x-4">
                <select 
                  className="bg-indigo-50 border border-indigo-200 text-indigo-700 text-xs font-bold py-1 px-2 rounded cursor-pointer max-w-[150px] sm:max-w-none"
                  value={currentUser.role}
                  onChange={(e) => {
                     const role = e.target.value;
                     const user = INITIAL_EMPLOYEES.find(emp => emp.role === role) || { ...INITIAL_EMPLOYEES[0], role, firstName: 'User', lastName: 'Test' };
                     setCurrentUser(user);
                     setViewMode('list');
                  }}
                >
                  <option value={ROLES.HR_ADMIN}>HR ADMIN (Toàn quyền)</option>
                  <option value={ROLES.MANAGER}>QUẢN LÝ (Xem nhóm)</option>
                  <option value={ROLES.EMPLOYEE}>NHÂN VIÊN (Cá nhân)</option>
                  <option value={ROLES.TECH_ADMIN}>IT ADMIN (Không xem lương)</option>
                </select>
                
                <div className="relative">
                  <Bell className="w-5 h-5 text-gray-400" />
                  <span className="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                </div>
              </div>
            </div>
          );

          const EmployeeList = () => (
            <div className="p-8">
              <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h1 className="text-2xl font-bold text-gray-900">Danh sách nhân viên</h1>
                {permissions.canManage(currentUser) && (
                  <button 
                    onClick={() => handleOpenModal('ADD_EMPLOYEE')}
                    className="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 flex items-center shadow-sm"
                  >
                    <Plus className="w-4 h-4 mr-2" />
                    Thêm nhân viên
                  </button>
                )}
              </div>

              <Card className="overflow-hidden">
                <div className="p-4 border-b border-gray-200 bg-gray-50 flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                  <div className="relative flex-1 max-w-md">
                    <Search className="absolute left-3 top-2.5 text-gray-400 w-4 h-4" />
                    <input 
                      type="text" 
                      placeholder="Tìm theo tên, ID, hoặc vị trí..." 
                      className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                    />
                  </div>
                  <select className="border border-gray-300 rounded-md text-sm px-3 py-2 bg-white">
                    <option>Tất cả phòng ban</option>
                    {DEPARTMENTS.map(d => <option key={d}>{d}</option>)}
                  </select>
                </div>

                <div className="overflow-x-auto">
                    <table className="w-full text-left border-collapse min-w-[800px]">
                      <thead>
                        <tr className="bg-gray-50 text-gray-500 text-xs uppercase tracking-wider">
                          <th className="px-6 py-4 font-medium">Nhân viên</th>
                          <th className="px-6 py-4 font-medium">Vị trí & Phòng ban</th>
                          <th className="px-6 py-4 font-medium">Trạng thái</th>
                          <th className="px-6 py-4 font-medium">Ngày gia nhập</th>
                          <th className="px-6 py-4 text-right">Thao tác</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-200">
                        {employees.map(emp => (
                          <tr key={emp.id} className="hover:bg-gray-50 transition-colors">
                            <td className="px-6 py-4">
                              <div className="flex items-center">
                                <div className="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-bold mr-3">
                                  {emp.avatar}
                                </div>
                                <div>
                                  <div className="font-medium text-gray-900">{emp.lastName} {emp.firstName}</div>
                                  <div className="text-xs text-gray-500">{emp.id}</div>
                                </div>
                              </div>
                            </td>
                            <td className="px-6 py-4">
                              <div className="text-sm text-gray-900">{emp.position}</div>
                              <div className="text-xs text-gray-500">{emp.department}</div>
                            </td>
                            <td className="px-6 py-4">
                              <Badge status={emp.status} />
                            </td>
                            <td className="px-6 py-4 text-sm text-gray-500">{emp.joinDate}</td>
                            <td className="px-6 py-4 text-right">
                              <button 
                                onClick={() => {
                                  setSelectedEmployee(emp);
                                  setViewMode('detail');
                                  setActiveTab('overview');
                                }}
                                className="text-blue-600 hover:text-blue-800 text-sm font-medium"
                              >
                                Xem hồ sơ
                              </button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                </div>
              </Card>
            </div>
          );

          const EmployeeDetail = () => {
            if (!selectedEmployee) return null;

            const tabs = [
              { id: 'overview', label: 'Tổng quan', icon: User },
              { id: 'personal', label: 'Thông tin cá nhân', icon: FileText },
              { id: 'employment', label: 'Việc làm', icon: Building },
              { id: 'compensation', label: 'Lương & Phúc lợi', icon: DollarSign },
              { id: 'documents', label: 'Tài liệu', icon: FileText },
              { id: 'history', label: 'Lịch sử', icon: Clock },
            ];

            return (
              <div className="p-8">
                <button 
                  onClick={() => setViewMode('list')}
                  className="flex items-center text-gray-500 hover:text-gray-900 mb-6 text-sm"
                >
                  <ChevronRight className="rotate-180 w-4 h-4 mr-1" />
                  Quay lại danh sách
                </button>

                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 flex flex-col md:flex-row justify-between items-start">
                  <div className="flex items-start space-x-6 mb-4 md:mb-0">
                    <div className="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center text-2xl font-bold text-slate-500 flex-shrink-0">
                      {selectedEmployee.avatar}
                    </div>
                    <div>
                      <h1 className="text-2xl font-bold text-gray-900">{selectedEmployee.lastName} {selectedEmployee.firstName}</h1>
                      <div className="text-gray-500 flex flex-wrap items-center mt-1 gap-3">
                        <span className="flex items-center text-sm"><Building className="w-4 h-4 mr-1"/> {selectedEmployee.department}</span>
                        <span className="flex items-center text-sm"><Users className="w-4 h-4 mr-1"/> {selectedEmployee.position}</span>
                      </div>
                      <div className="mt-3 flex space-x-2">
                        <Badge status={selectedEmployee.status} />
                      </div>
                    </div>
                  </div>
                  <div className="flex flex-col items-start md:items-end space-y-2 w-full md:w-auto">
                    <div className="text-left md:text-right">
                      <div className="text-xs text-gray-500">Mã Nhân Viên</div>
                      <div className="font-mono font-medium">{selectedEmployee.id}</div>
                    </div>
                    {permissions.canManage(currentUser) && selectedEmployee.status !== 'Đã nghỉ việc' && (
                      <button 
                        onClick={handleTerminate}
                        className="bg-red-50 text-red-600 border border-red-200 px-4 py-2 rounded-md text-sm hover:bg-red-100 transition-colors flex items-center"
                      >
                        <UserMinus className="w-4 h-4 mr-2" />
                        Cho nghỉ việc
                      </button>
                    )}
                  </div>
                </div>

                <div className="flex space-x-1 border-b border-gray-200 mb-6 overflow-x-auto pb-1">
                  {tabs.map(tab => {
                    const IconComp = tab.icon;
                    return (
                        <button
                          key={tab.id}
                          onClick={() => setActiveTab(tab.id)}
                          className={`flex items-center px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${
                            activeTab === tab.id 
                              ? 'border-blue-600 text-blue-600' 
                              : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                          }`}
                        >
                          <IconComp className="w-4 h-4 mr-2" />
                          {tab.label}
                        </button>
                    );
                  })}
                </div>

                <div className="min-h-[400px]">
                  {activeTab === 'overview' && <OverviewTab employee={selectedEmployee} />}
                  {activeTab === 'personal' && <PersonalTab employee={selectedEmployee} viewer={currentUser} onEdit={() => handleOpenModal('EDIT_PERSONAL', selectedEmployee)} />}
                  {activeTab === 'employment' && <EmploymentTab employee={selectedEmployee} />}
                  {activeTab === 'compensation' && <CompensationTab employee={selectedEmployee} viewer={currentUser} onAdjust={() => handleOpenModal('ADJUST_SALARY', { currentSalary: selectedEmployee.salary })} />}
                  {activeTab === 'documents' && <DocumentsTab employee={selectedEmployee} viewer={currentUser} onUpload={() => handleOpenModal('UPLOAD_DOC')} />}
                  {activeTab === 'history' && <HistoryTab employee={selectedEmployee} logs={auditLogs} />}
                </div>
              </div>
            );
          };

          const OverviewTab = ({ employee }) => (
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              <Card className="col-span-2 p-6">
                <h3 className="text-lg font-bold text-gray-900 mb-4">Thông tin liên hệ</h3>
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-y-4 gap-x-8">
                  <DetailRow label="Email công việc" value={employee.email} />
                  <DetailRow label="Số điện thoại" value={employee.phone} />
                  <DetailRow label="Địa điểm làm việc" value={employee.location} />
                  <DetailRow label="Quản lý trực tiếp" value={employees.find(e => e.id === employee.managerId)?.firstName || 'Không có'} />
                </div>
              </Card>
              <Card className="p-6 bg-blue-50 border-blue-100">
                <h3 className="text-sm font-bold text-blue-900 mb-2 uppercase tracking-wide">Thâm niên</h3>
                <div className="text-3xl font-bold text-blue-800 mb-1">
                  {Math.floor((new Date() - new Date(employee.joinDate)) / (1000 * 60 * 60 * 24 * 365))} Năm
                </div>
                <p className="text-blue-600 text-sm">Ngày gia nhập: {employee.joinDate}</p>
              </Card>
            </div>
          );

          const PersonalTab = ({ employee, viewer, onEdit }) => {
            const isRestricted = !permissions.canEditSensitive(viewer) && viewer.id !== employee.id;

            return (
              <div className="space-y-6">
                <Card className="p-6">
                  <div className="flex justify-between mb-4">
                    <h3 className="text-lg font-bold text-gray-900">Thông tin cơ bản</h3>
                    {!isRestricted && (
                      <button onClick={onEdit} className="text-blue-600 text-sm font-medium flex items-center hover:bg-blue-50 px-2 py-1 rounded">
                        <Edit3 className="w-4 h-4 mr-1" /> Chỉnh sửa
                      </button>
                    )}
                  </div>
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    <DetailRow label="Ngày sinh" value={isRestricted ? '●●/●●/●●●●' : employee.dob} />
                    <DetailRow label="Giới tính" value={employee.gender} />
                    <DetailRow label="Quốc tịch" value={employee.nationality} />
                    <DetailRow label="Địa chỉ hiện tại" value={employee.address} />
                  </div>
                </Card>

                <Card className="p-6 relative overflow-hidden">
                  {isRestricted && (
                    <div className="absolute inset-0 bg-gray-50/90 backdrop-blur-[1px] flex items-center justify-center z-10">
                      <div className="flex flex-col items-center">
                        <Lock className="text-gray-400 mb-2 w-6 h-6" />
                        <span className="text-sm font-medium text-gray-500">Thông tin định danh bị ẩn để bảo mật</span>
                      </div>
                    </div>
                  )}
                  <h3 className="text-lg font-bold text-gray-900 mb-4 flex items-center">
                    <Shield className="w-5 h-5 text-gray-400 mr-2" />
                    Định danh & Bảo mật
                  </h3>
                  <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
                    <DetailRow label="Số CCCD / CMND" value={employee.nationalId} isSensitive={true} />
                    <DetailRow label="Mã số thuế" value="8822991122" isSensitive={true} />
                  </div>
                </Card>

                <Card className="p-6">
                  <h3 className="text-lg font-bold text-gray-900 mb-4">Liên hệ khẩn cấp</h3>
                  <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
                    <DetailRow label="Họ tên" value={employee.emergencyContact?.name} />
                    <DetailRow label="Mối quan hệ" value={employee.emergencyContact?.relation} />
                    <DetailRow label="Số điện thoại" value={employee.emergencyContact?.phone} />
                  </div>
                </Card>
              </div>
            );
          };

          const CompensationTab = ({ employee, viewer, onAdjust }) => {
            const [showHistory, setShowHistory] = useState(false);

            if (!permissions.canViewSalary(viewer, employee)) {
              return (
                <div className="flex flex-col items-center justify-center p-12 text-center bg-gray-50 rounded-lg border border-dashed border-gray-300">
                  <Lock className="w-12 h-12 text-gray-400 mb-3" />
                  <h3 className="text-lg font-medium text-gray-900">Truy cập bị hạn chế</h3>
                  <p className="text-gray-500 max-w-sm mt-1">Dữ liệu lương chỉ hiển thị với Nhân sự và bản thân nhân viên.</p>
                </div>
              );
            }

            const formatter = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: employee.currency });

            return (
              <div className="space-y-6">
                <Card className="p-6 bg-slate-50 border-slate-200">
                  <div className="flex justify-between items-start mb-6">
                    <div>
                      <h2 className="text-xs uppercase tracking-wide text-slate-500 font-semibold">Mức lương cơ bản hiện tại</h2>
                      <div className="text-4xl font-bold text-slate-900 mt-2">{formatter.format(employee.salary)}</div>
                      <div className="text-sm text-slate-500 mt-1">Chu kỳ: Hàng tháng</div>
                    </div>
                    {permissions.canManage(viewer) && (
                      <button 
                        onClick={onAdjust}
                        className="bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700 shadow-sm flex items-center"
                      >
                        <DollarSign className="w-4 h-4 mr-1" />
                        Điều chỉnh lương
                      </button>
                    )}
                  </div>
                </Card>

                <div className="flex justify-end">
                   <button onClick={() => setShowHistory(!showHistory)} className="text-blue-600 text-sm font-medium flex items-center hover:underline">
                     {showHistory ? 'Ẩn lịch sử' : 'Xem lịch sử lương'}
                   </button>
                </div>

                {showHistory && (
                  <Card className="overflow-hidden animate-fade-in">
                    <table className="w-full text-left">
                      <thead className="bg-gray-50 text-xs text-gray-500 uppercase">
                        <tr>
                          <th className="px-6 py-3">Ngày hiệu lực</th>
                          <th className="px-6 py-3">Lý do thay đổi</th>
                          <th className="px-6 py-3">Người thực hiện</th>
                          <th className="px-6 py-3 text-right">Số tiền</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-gray-100 text-sm">
                        {employee.salaryHistory.map((rec, i) => (
                          <tr key={i}>
                            <td className="px-6 py-3">{rec.date}</td>
                            <td className="px-6 py-3">{rec.type}</td>
                            <td className="px-6 py-3 text-gray-500">{rec.changedBy}</td>
                            <td className="px-6 py-3 text-right font-medium">{formatter.format(rec.amount)}</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </Card>
                )}
              </div>
            );
          };

          const DocumentsTab = ({ employee, viewer, onUpload }) => (
            <div className="space-y-4">
              <div className="flex justify-between items-center mb-4">
                <h3 className="font-bold text-gray-900">Tài liệu nhân viên</h3>
                {permissions.canManage(viewer) && (
                   <button 
                    onClick={onUpload}
                    className="border border-gray-300 bg-white px-3 py-1.5 rounded text-sm font-medium hover:bg-gray-50 flex items-center"
                   >
                     <Upload className="w-4 h-4 mr-2" />
                     Tải tài liệu lên
                   </button>
                )}
              </div>
              
              {employee.documents.length === 0 ? (
                <div className="text-center py-12 text-gray-400 italic bg-gray-50 rounded-lg border border-dashed border-gray-300">
                  Chưa có tài liệu nào được tải lên
                </div>
              ) : (
                <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                  {employee.documents.map(doc => {
                    if (!permissions.canViewDocuments(viewer, employee, doc.accessLevel)) return null;
                    return (
                      <div key={doc.id} className="border border-gray-200 p-4 rounded-lg flex items-start space-x-3 hover:bg-gray-50 transition-colors cursor-pointer group">
                        <div className="p-2 bg-red-50 rounded text-red-600">
                          <FileText className="w-6 h-6" />
                        </div>
                        <div className="flex-1 min-w-0">
                          <div className="font-medium text-sm text-gray-900 truncate">{doc.name}</div>
                          <div className="text-xs text-gray-500 mt-1">{doc.type} • {doc.date}</div>
                          <div className="mt-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
                            {doc.accessLevel === 'HR_ONLY' ? <Lock className="w-3 h-3 mr-1"/> : null}
                            {doc.accessLevel === 'HR_ONLY' ? 'Nội bộ HR' : 'Công khai'}
                          </div>
                        </div>
                        <Download className="w-4 h-4 text-gray-400 group-hover:text-blue-600" />
                      </div>
                    );
                  })}
                </div>
              )}
            </div>
          );

          const HistoryTab = ({ employee, logs }) => {
            const history = logs.filter(l => l.target.includes(employee.lastName));

            return (
              <Card className="overflow-hidden">
                <div className="p-4 border-b border-gray-200 bg-gray-50">
                  <h3 className="font-bold text-gray-900">Nhật ký hoạt động (Audit Log)</h3>
                </div>
                <div className="max-h-96 overflow-y-auto">
                  {history.length === 0 ? (
                    <div className="p-8 text-center text-gray-500">Chưa có hoạt động nào được ghi nhận.</div>
                  ) : (
                    <ul className="divide-y divide-gray-200">
                      {history.map(log => (
                        <li key={log.id} className="p-4 hover:bg-gray-50">
                          <div className="flex space-x-3">
                            <div className="flex-shrink-0">
                              <div className="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center">
                                <Activity className="w-4 h-4 text-gray-600" />
                              </div>
                            </div>
                            <div className="min-w-0 flex-1">
                              <p className="text-sm font-medium text-gray-900">
                                {log.action.replace(/_/g, ' ')}
                              </p>
                              <p className="text-sm text-gray-500">
                                thực hiện bởi <span className="font-medium text-gray-900">{log.actor}</span>
                              </p>
                              <p className="text-xs text-gray-400 mt-1">{log.details}</p>
                            </div>
                            <div className="flex-shrink-0 text-right text-xs text-gray-500 whitespace-nowrap">
                              {log.timestamp}
                            </div>
                          </div>
                        </li>
                      ))}
                    </ul>
                  )}
                </div>
              </Card>
            );
          };

          const DetailRow = ({ label, value, isSensitive = false }) => (
            <div>
              <dt className="text-xs font-medium text-gray-500 uppercase tracking-wide">{label}</dt>
              <dd className="mt-1 text-sm text-gray-900 font-medium">
                {isSensitive ? (
                  <span className="flex items-center group cursor-help w-fit">
                    <span className="filter blur-[4px] group-hover:blur-none transition-all duration-300 select-none bg-gray-100 px-1 rounded">
                      {value}
                    </span>
                    <EyeOff className="w-3 h-3 text-gray-400 ml-2 group-hover:hidden" />
                  </span>
                ) : (
                  value || '-'
                )}
              </dd>
            </div>
          );

          const EmploymentTab = ({ employee }) => (
            <Card className="p-6">
              <h3 className="text-lg font-bold text-gray-900 mb-4">Thông tin công việc</h3>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-y-6 gap-x-12">
                <DetailRow label="Chức danh" value={employee.position} />
                <DetailRow label="Phòng ban" value={employee.department} />
                <DetailRow label="Quản lý trực tiếp" value={employees.find(e => e.id === employee.managerId)?.firstName ? `${employees.find(e => e.id === employee.managerId).lastName} ${employees.find(e => e.id === employee.managerId).firstName}` : '-'} />
                <DetailRow label="Loại hình nhân viên" value="Toàn thời gian (Full-time)" />
                <DetailRow label="Địa điểm" value={employee.location} />
                <DetailRow label="Ngày bắt đầu" value={employee.joinDate} />
              </div>
            </Card>
          );
          
          return (
            <div className="flex bg-gray-100 min-h-screen font-sans">
              <Sidebar />
              <div className="flex-1 ml-0 md:ml-64">
                <Header />
                <main className="min-h-[calc(100vh-64px)]">
                  {viewMode === 'list' ? <EmployeeList /> : <EmployeeDetail />}
                </main>
              </div>

              {/* MODALS */}
              <Modal isOpen={modalConfig.isOpen && modalConfig.type === 'ADD_EMPLOYEE'} onClose={handleCloseModal} title="Thêm Nhân Viên Mới">
                <form onSubmit={handleAddEmployee} className="space-y-4">
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Họ & Tên đệm</label>
                      <input name="lastName" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Tên</label>
                      <input name="firstName" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Email công ty</label>
                    <input type="email" name="email" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none" />
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Phòng ban</label>
                      <select name="department" onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm">
                        {DEPARTMENTS.map(d => <option key={d} value={d}>{d}</option>)}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Chức vụ</label>
                      <input name="position" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Lương khởi điểm (VND)</label>
                    <input type="number" name="salary" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                  </div>
                  <div className="pt-4 flex justify-end space-x-3">
                    <button type="button" onClick={handleCloseModal} className="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">Hủy</button>
                    <button type="submit" className="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700">Tạo nhân viên</button>
                  </div>
                </form>
              </Modal>

              <Modal isOpen={modalConfig.isOpen && modalConfig.type === 'EDIT_PERSONAL'} onClose={handleCloseModal} title="Cập Nhật Hồ Sơ">
                <form onSubmit={handleUpdatePersonal} className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Số điện thoại</label>
                    <input name="phone" defaultValue={modalConfig.data?.phone} onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Địa chỉ thường trú</label>
                    <textarea name="address" defaultValue={modalConfig.data?.address} onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                  </div>
                  <div className="pt-4 flex justify-end space-x-3">
                     <button type="button" onClick={handleCloseModal} className="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">Hủy</button>
                     <button type="submit" className="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700">Lưu thay đổi</button>
                  </div>
                </form>
              </Modal>

              <Modal isOpen={modalConfig.isOpen && modalConfig.type === 'ADJUST_SALARY'} onClose={handleCloseModal} title="Điều Chỉnh Lương & Thưởng">
                <form onSubmit={handleSalaryAdjustment} className="space-y-4">
                  <div className="bg-blue-50 p-3 rounded-md mb-4">
                     <div className="text-xs text-blue-700 font-semibold uppercase">Lương hiện tại</div>
                     <div className="text-xl font-bold text-blue-900">{new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(modalConfig.data?.currentSalary || 0)}</div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Mức lương mới (VND)</label>
                    <input type="number" name="newSalary" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm font-bold text-gray-900" placeholder="Ví dụ: 15000000" />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Ngày hiệu lực</label>
                    <input type="date" name="effectiveDate" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Lý do điều chỉnh</label>
                    <select name="reason" onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm">
                      <option value="">-- Chọn lý do --</option>
                      <option value="Đánh giá định kỳ">Đánh giá hiệu suất định kỳ</option>
                      <option value="Thăng chức">Thăng chức / Bổ nhiệm mới</option>
                      <option value="Điều chỉnh lạm phát">Điều chỉnh lạm phát</option>
                    </select>
                  </div>
                  <div className="pt-4 flex justify-end space-x-3">
                     <button type="button" onClick={handleCloseModal} className="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">Hủy</button>
                     <button type="submit" className="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700">Xác nhận tăng lương</button>
                  </div>
                </form>
              </Modal>

              <Modal isOpen={modalConfig.isOpen && modalConfig.type === 'UPLOAD_DOC'} onClose={handleCloseModal} title="Tải Lên Tài Liệu Số">
                <form onSubmit={handleUploadDocument} className="space-y-4">
                  <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:bg-gray-50 transition-colors cursor-pointer">
                    <Upload className="mx-auto h-12 w-12 text-gray-400" />
                    <p className="mt-2 text-sm text-gray-600">Kéo thả file PDF vào đây hoặc click để chọn</p>
                  </div>
                  <div>
                     <label className="block text-sm font-medium text-gray-700">Tên hiển thị</label>
                     <input name="fileName" placeholder="VD: Hợp đồng lao động 2024" required onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
                  </div>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Loại tài liệu</label>
                      <select name="docType" onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm">
                        <option value="Hợp đồng">Hợp đồng</option>
                        <option value="Chứng chỉ">Chứng chỉ / Bằng cấp</option>
                        <option value="Quyết định">Quyết định bổ nhiệm</option>
                        <option value="Khác">Khác</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Phân quyền</label>
                      <select name="accessLevel" onChange={handleInputChange} className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-sm">
                        <option value="HR_ONLY">Bảo mật (Chỉ HR)</option>
                        <option value="PUBLIC">Công khai (Quản lý xem được)</option>
                      </select>
                    </div>
                  </div>
                  <div className="pt-4 flex justify-end space-x-3">
                     <button type="button" onClick={handleCloseModal} className="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200">Hủy</button>
                     <button type="submit" className="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700">Tải lên</button>
                  </div>
                </form>
              </Modal>

            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<NexusHR />);
    </script>
</body>
</html>